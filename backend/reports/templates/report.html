<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Repository Analysis Report</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            color: #333;
        }

        h1 { color: #3366cc; }
        .section {
            margin-bottom: 25px;
            padding: 15px;
            background: #f7f7f7;
            border-radius: 8px;
        }

        .repo-box {
            padding: 10px;
            border-left: 4px solid #4CAF50;
            margin-bottom: 10px;
            background: #fff;
        }

        .score {
            font-weight: bold;
            color: #4CAF50;
        }
    </style>
</head>

<body>

<h1>Repository Similarity Analysis Report</h1>

<div class="section">
    <h2>Input Repository</h2>
    <p>{{ data.input_repo }}</p>
</div>

<div class="section">
    <h2>Top 3 Similar Repositories</h2>

    {% if data.top_3_repos %}
        {% for repo in data.top_3_repos %}
            <div class="repo-box">
                <p><b>Repository:</b> {{ repo.repo_url }}</p>
                <p><b>Similarity:</b> <span class="score">{{ repo.final_similarity * 100 }}%</span></p>
            </div>
        {% endfor %}
    {% else %}
        <p>No similar repositories found.</p>
    {% endif %}
</div>

<div class="section">
    <h2>All Repository Scores (Detailed)</h2>

    {% for repo in data.all_repo_scores %}
        <div class="repo-box">
            <p><b>{{ repo.repo_url }}</b></p>
            <p>Similarity: {{ repo.final_similarity * 100 }}%</p>

            <details>
                <summary>Agent Breakdown</summary>
                <ul>
                    {% for agent in repo.agent_scores %}
                        <li>{{ agent.agent }} â†’ {{ agent.score }}</li>
                    {% endfor %}
                </ul>
            </details>
        </div>
    {% endfor %}
</div>

</body>
</html>
